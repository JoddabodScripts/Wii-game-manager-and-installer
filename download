#!/bin/bash

# Download Script - Complete version with all options
# Usage: download

VIMM_URL="https://vimm.net/vault/?p=list&system=Wii"

# Show help
show_help() {
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë                DOWNLOAD SCRIPT - VIMM'S LAIR             ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "USAGE:"
    echo "  download                    # Open Vimm's Lair Wii list"
    echo "  download --help             # Show this help"
    echo "  download --search \"game\"    # Search for specific game"
    echo "  download --browse           # Browse all Wii games"
    echo "  download --suggest          # Game recommendations"
    echo "  download --tools            # Wii homebrew/tools"
    echo ""
    echo "üí° CORRECT SEARCH URL:"
    echo "  https://vimm.net/vault/?p=list&system=Wii&q=searchterm"
    echo ""
    echo "WORKFLOW:"
    echo "  1. download --search \"game name\"  # Find game"
    echo "  2. Download .wbfs to ~/Downloads/  # Save it"
    echo "  3. wii                             # Auto-organizes"
    echo "  4. Play on Wii! üéÆ"
    echo ""
    exit 0
}

# CORRECT search function
search_game() {
    if [ -z "$1" ]; then
        echo "‚ùå Please provide a search term"
        echo "Usage: download --search \"super mario\""
        exit 1
    fi
    
    SEARCH_TERM=$(echo "$1" | sed 's/ /+/g')
    SEARCH_URL="https://vimm.net/vault/?p=list&system=Wii&q=$SEARCH_TERM"
    
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë                SEARCHING VIMM'S LAIR                     ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üîç Searching for: $1"
    echo "üåê Opening: $SEARCH_URL"
    echo ""
    echo "üìù ON VIMM'S LAIR:"
    echo "  1. Results show in list view"
    echo "  2. Click any game to open its page"
    echo "  3. Look for '.wbfs' download links"
    echo "  4. Save files to: ~/Downloads/"
    echo ""
    
    # Open browser
    if command -v xdg-open &> /dev/null; then
        xdg-open "$SEARCH_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    elif command -v open &> /dev/null; then
        open "$SEARCH_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    else
        echo "üåê Please visit: $SEARCH_URL"
    fi
    
    echo ""
    echo "üéÆ After downloading, run: wii (auto-organizes everything!)"
    exit 0
}

# Browse all Wii games
browse_games() {
    BROWSE_URL="https://vimm.net/vault/?p=list&system=Wii"
    
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë                BROWSE ALL WII GAMES                     ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üìö Opening full Wii games list..."
    echo ""
    echo "üåê URL: $BROWSE_URL"
    echo ""
    echo "üí° Tips:"
    echo "  ‚Ä¢ Games sorted alphabetically"
    echo "  ‚Ä¢ Click any game for details"
    echo "  ‚Ä¢ Use browser search (Ctrl+F) to find specific games"
    echo "  ‚Ä¢ Download .wbfs files to ~/Downloads/"
    echo ""
    
    if command -v xdg-open &> /dev/null; then
        xdg-open "$BROWSE_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    elif command -v open &> /dev/null; then
        open "$BROWSE_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    else
        echo "üåê Please visit: $BROWSE_URL"
    fi
    
    exit 0
}

# Game recommendations
suggest_games() {
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë               GAME RECOMMENDATIONS                      ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üéØ TOP PICKS:"
    echo ""
    echo "  üèéÔ∏è  Mario Kart Wii"
    echo "  ‚öæ Wii Sports"
    echo "  üëä Wii Sports Resort"
    echo "  üèùÔ∏è  Super Mario Galaxy"
    echo "  üåå Super Mario Galaxy 2"
    echo "  üçÑ New Super Mario Bros. Wii"
    echo "  ‚öîÔ∏è  The Legend of Zelda: Twilight Princess"
    echo "  üëæ Super Smash Bros. Brawl"
    echo "  üî´ Metroid Prime Trilogy"
    echo "  üåå Xenoblade Chronicles"
    echo ""
    echo "üîç SEARCH COMMANDS:"
    echo "  download --search \"mario kart\""
    echo "  download --search \"zelda\""
    echo "  download --search \"metroid\""
    echo "  download --browse           # See ALL games"
    echo ""
    exit 0
}

# Open Wii tools/homebrew section
open_tools() {
    TOOLS_URL="https://wii.hacks.guide/recommended-homebrew"
    
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë                WII HOMEBREW & TOOLS                     ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üõ†Ô∏è  Opening Wii homebrew/tools..."
    echo ""
    echo "üîß Common tools:"
    echo "  ‚Ä¢ USB Loader GX"
    echo "  ‚Ä¢ Homebrew Channel"
    echo "  ‚Ä¢ Nintendont (GameCube)"
    echo "  ‚Ä¢ Emulators"
    echo "  ‚Ä¢ Save managers"
    echo ""
    echo "üåê URL: $TOOLS_URL"
    echo ""
    
    if command -v xdg-open &> /dev/null; then
        xdg-open "$TOOLS_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    elif command -v open &> /dev/null; then
        open "$TOOLS_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    else
        echo "üåê Please visit: $TOOLS_URL"
    fi
    
    exit 0
}

# Main function - open Vimm's Lair
open_vimm() {
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë                VIMM'S LAIR - WII LIST                   ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üéÆ Opening Wii games list..."
    echo ""
    echo "üåê URL: $VIMM_URL"
    echo ""
    echo "üí° Quick commands:"
    echo "  download --search \"game\"    # Search for specific game"
    echo "  download --browse           # Browse all games"
    echo "  download --suggest          # Get recommendations"
    echo "  download --tools            # Homebrew tools"
    echo ""
    
    if command -v xdg-open &> /dev/null; then
        xdg-open "$VIMM_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    elif command -v open &> /dev/null; then
        open "$VIMM_URL" 2>/dev/null &
        echo "‚úÖ Opening in browser..."
    else
        echo "üåê Please visit: $VIMM_URL"
    fi
    
    exit 0
}

# Main function
main() {
    case "$1" in
        "--help"|"-h")
            show_help
            ;;
        "--search"|"-s")
            search_game "$2"
            ;;
        "--browse"|"-b")
            browse_games
            ;;
        "--suggest"|"-g")
            suggest_games
            ;;
        "--tools"|"-t")
            open_tools
            ;;
        "")
            open_vimm
            ;;
        *)
            echo "‚ùå Unknown option: $1"
            echo "Use 'download --help' for usage information"
            exit 1
            ;;
    esac
}

# Run main function
main "$@"
